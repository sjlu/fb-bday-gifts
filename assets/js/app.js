var friends,frontpage,user,friend;$(document).ready(function(){frontpage=new Frontpage,friends=new Friends,user=new User,friend=new Friend,gifts=new Gifts,window.fbAsyncInit=function(){FB.init({appId:"402923146436440",channelUrl:"channel.html",status:!0,cookie:!0,xfbml:!0}),FB.Event.subscribe("auth.login",function(a){frontpage.login_callback()}),FB.getLoginStatus(function(a){a.status==="connected"&&frontpage.login_callback()}),$("#loading-header").remove()},function(a){var b,c="facebook-jssdk",d=a.getElementsByTagName("script")[0];if(a.getElementById(c))return;b=a.createElement("script"),b.id=c,b.async=!0,b.src="//connect.facebook.net/en_US/all.js",d.parentNode.insertBefore(b,d)}(document)});var Friend=function(){function b(b){for(var c=0;c<b.data.length;c++)a.likes.push(b.data[c].name);var d=0;for(var c=0;c<a.likes.length;c++){if(d++>10)break;gifts.search(a.likes[c])}}function c(a){FB.api(a+"/likes",b)}var a={};return a.likes=[],a.lookup=c,a},Friends=function(){function b(){$("#loading").remove(),$("html, body").animate({scrollTop:$("#friends").offset().top},"slow"),$("#friends-header").fadeIn();for(var b=0;b<a.friends.length;b++){var c=a.friends[b],d='<li class="span3" style="display: none;"><div class="thumbnail"><img src="'+c.pic_big+'" /><h4>'+c.name+'</h4><p><img src="assets/img/gift.png" /> '+c.birthday_date+'</p><a class="btn btn-primary" data-fbid="'+c.uid+'">Find Gifts</a></div></li>';$("#friends").append(d)}$("#friends li").fadeIn(),$("#friends a").click(function(){friend.lookup($(this).attr("data-fbid")),$("#suggestions-header").fadeIn(),$("#suggestions").empty(),$("#suggestions").css("height","800px"),$("html, body").animate({scrollTop:$("#suggestions-header").offset().top},"slow")})}function c(){$("#header").after('<h1 id="loading">Looking up your friends :)</h1>');var c=new Date,d={day:c.getDay(),month:c.getMonth()};c.setDate(c.getDate()+90);var e={day:c.getDay(),month:c.getMonth()};FB.api({method:"fql.query",query:"SELECT uid, name, birthday_date, pic_big FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND strlen(birthday_date) != 0 AND ((substr(birthday_date, 0, 2) = "+d.month+" AND substr(birthday_date, 3, 5) >= "+d.day+") OR (substr(birthday_date, 0, 2) = "+e.month+" AND substr(birthday_date, 3, 5) < "+e.day+")) ORDER BY birthday_date"},function(c){a.friends=c,b()})}function d(){return a.friends}var a={};return a.lookup=c,a.get=d,a},Frontpage=function(){function b(){user.lookup(),friends.lookup(),$(".fb-login-button").remove()}function c(){var a=this;FB.login(b,{scope:"friends_birthday,friends_likes,friends_interests"})}function d(){FB.logout()}var a={};return a.login_callback=b,a.login=c,a.logout=d,a},Gifts=function(){function c(a){$.get(b+encodeURIComponent(a),function(a){if(typeof a.items=="undefined")return;var b=a.items,c=0;for(var d=0;d<b.length;d++){if(c++>2)break;var e=b[d].product;if(typeof e.images=="undefined")continue;var f={name:e.title,link:e.link,image:e.images[0].link};$("#suggestions").append('<li class="span3"><div class="thumbnail"><img src="'+f.image+'" /><h4>'+f.name+'</h4><a class="btn btn-primary" href="'+f.link+' target="_new">Buy</a></div>')}})}var a={},b="https://www.googleapis.com/shopping/search/v1/public/products?key=AIzaSyDCUFzKWkifF4EjySmXdtmSt6Q_fjum3yA&country=US&q=";return a.search=c,a},User=function(){function b(){FB.api("/me",function(b){a.first_name=b.first_name})}function c(){return a.first_name}var a={};return a.lookup=b,a.get=c,a};